#include "aes.cpp";
#include "aes_tbox.cpp";


double test_aes_unoptimized(int n){
    uint8_t key[16] = { 0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff };
    uint8_t in[16] =  { 0xab, 0xcd, 0xef, 0x01, 0x23, 0x45, 0x67, 0x89, 0xab, 0xcd, 0xef, 0x01, 0x23, 0x45, 0x67, 0x89};
    uint8_t out[16] = { 0, /*...*/ };
    uint8_t res_out[16] = { 0xa3, 0x3a, 0xca, 0x68, 0x72, 0xa2, 0x27, 0x74, 0xbf, 0x99, 0xf3, 0x71, 0xaa, 0x99, 0xd2, 0x5a };

    clock_t tStart = clock();

    for(int i=0; i < n; i++)
        aes(in, out, key);
    printf("Time taken unoptimized AES algorithm: %.10fs\n", ((double)(clock() - tStart)/CLOCKS_PER_SEC));
}

double test_aes_optimized(int n){
    uint8_t key[16] = { 0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff };
    uint8_t in[16] =  { 0xab, 0xcd, 0xef, 0x01, 0x23, 0x45, 0x67, 0x89, 0xab, 0xcd, 0xef, 0x01, 0x23, 0x45, 0x67, 0x89};
    uint8_t out[16] = { 0, /*...*/ };
    uint8_t res_out[16] = { 0xa3, 0x3a, 0xca, 0x68, 0x72, 0xa2, 0x27, 0x74, 0xbf, 0x99, 0xf3, 0x71, 0xaa, 0x99, 0xd2, 0x5a };

    clock_t tStart = clock();
    init_tboxes_o();

    for(int i=0; i < n; i++)
        aes_o(in, out, key);
    printf("Time taken optimized AES algorithm: %.10fs\n", ((double)(clock() - tStart)/CLOCKS_PER_SEC));
}

int main(int argc, char* argv[]){
    int rounds=1000000;

    test_aes_unoptimized(rounds);
    test_aes_optimized(rounds);
}